import type { NextPage } from 'next';
import Head from 'next/head';
import { FormEvent, useCallback, useRef } from 'react';
import { useRouter } from 'next/router';
import { SearchQuery } from '../lib/SearchQuery';

const Home: NextPage = () => {
	const router = useRouter();
	const searchRef = useRef<HTMLInputElement>(null);

	const onFormSubmit = useCallback(async (e: FormEvent) => {
		e.preventDefault();
		if (!searchRef.current) return;
		const searchQuery = new SearchQuery(searchRef.current.value);
		router.push(searchQuery.getUrl());
	}, []);

	return (
		<>
			<Head>
				<title>Create T3 App</title>
				<meta name="description" content="Generated by create-t3-app" />
				<link rel="icon" href="/favicon.ico" />
			</Head>

			<main>
				<form onSubmit={onFormSubmit} className="flex gap-2">
					<input
						type="text"
						placeholder="Search..."
						className="border-2 border-gray-400 px-2"
						ref={searchRef}
					/>
					<button
						type="submit"
						className="border-1 rounded-2xl bg-[#83A5FF] px-4 py-2 text-white"
					>
						Submit
					</button>
				</form>
			</main>
		</>
	);
};

export default Home;
